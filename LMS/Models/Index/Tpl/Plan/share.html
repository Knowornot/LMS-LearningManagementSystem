<extend name="./LMS/Models/Index/Tpl/base.html" />
<block name="title">
	学习计划分享-{$data['plan']['name']}
</block>
<block name="leader">
</block>
<block name="left-bar">
</block>
<block name="CSS_AND_JS">
	<!--特色JS/CSS-->
	<link rel="stylesheet" type="text/css" href="__PUBLIC__/css/plan/plan_list.css" />
	<script type="text/javascript">
        var mode={$data.mode};
        var urlUniqid='{$url_uniqid}';
        var praiseUrl="{:U(GROUP_NAME.'/Plan/praise')}";
        var pid={$data['id']};
        var praised='{$praised}';
	</script>
    <script type="text/javascript" src="__PUBLIC__/js/plan/share.js"></script>
	<!--/特色JS/CSS-->
</block>
<block name="body">
	<!--展示封面和各种信息-->
	<div class="row">
		<div class="col-md-5">
			<div class="thumbnail" style="margin-top:15px;">
				<img src="{$data['face']}" alt="" style="width:100%;" />
				<div class="caption">
					<button class="btn">
						<span class="glyphicon glyphicon-user"></span>
						{$studyPeople}人参加
					</button>
					<button id="praise-btn" class="btn btn-success">
						<span class="glyphicon glyphicon-thumbs-up"></span>
						<span class="praise">赞</span>(<span class="num">{$data['praised']}</span>)
					</button>
                    <!--如果不是自己的计划-->
                    <button class="btn btn-success">
                        <span class="glyphicon glyphicon-plus"></span>
                        参加此计划
                    </button>
					<a class="btn btn-warning" href="{:U(GROUP_NAME.'/Plan/comment',array('pid'=>$data['id']))}" target="_blank">
						<span class="glyphicon glyphicon-flag"></span>
						查看评论(1)
					</a>
				</div>
			</div>
		</div>
		<div class="col-md-7">
			<h3>{$data['name']}</h3>
			<ul class="list-inline">
				<li>
					<span class="glyphicon glyphicon-eye-open"></span>
					{$data['saw']}
				</li>
				<li class="text-success">
					<span class="glyphicon glyphicon-star"></span>
					<span class="glyphicon glyphicon-star"></span>
					<span class="glyphicon glyphicon-star"></span>
					<span class="glyphicon glyphicon-star-empty"></span>
					<span class="glyphicon glyphicon-star-empty"></span>
					<span class="text-info">(48)</span>
				</li>
				<li>
					创建者：<a href="">{$data.creator.username}</a>
				</li>
			</ul>
			<ul class="list-unstyled">
				<li class="">
					分享链接：
					<a href="{:U(GROUP_NAME.'/Plan/share',array('pid'=>$data['id']))}">{:U(GROUP_NAME.'/Plan/share',array('pid'=>$data['id']),false,false,true)}</a>
				</li>
			</ul>
			<hr>
			<div class="well clearfix">
			<!--各种时间信息-->
			<table class="col-md-6">
				<tr>
					<td>
						创建时间：
					</td>
					<td>
						{:date('Y-m-d H:i:s',$data['create_time'])}
					</td>
				</tr>
                <tr>
                    <td>
                        计划总时长：
                    </td>
                    <td class="text-danger">
                        {$data['total']}h
                    </td>
                </tr>
			</table>
				<!--完成情况和延期情况！-->
			<table class="col-md-6">
				<tr>
					<td>
						计划类型：
					</td>
					<td>
						<if condition="$data['mode'] eq 1">
							顺序模式
							<else/>
							列表模式
						</if>
					</td>
				</tr>
                <tr>
                    <td>总任务：</td>
                    <td class="text-success">{$data.mission_total}个</td>
                </tr>
			</table>
			</div>
		</div>
	</div>
	<hr>
    <if condition="$data['open']">
        <div class="row">
            <div class="col-md-12">
                <table class="table table-responsive table-hover plan-list">
                    <foreach name="data['stage']" item="val">
                        <tr class="stage">
                            <td class="first">
                                阶段
                            </td>
                            <td class="circle-warp col-md-1 text-center">
							<span class="circle-md">
								{++$i}
							</span>
                            </td>
                            <td>
							<span class="">
								{$val.name}
							</span>
                                <span class="help-block small" style="padding-left:30px;display:inline;">
								描述：{$val.info}
							</span>
                            </td>
                            <td>
                            </td>
                        </tr>
                        <span class="hidden">{$j=0}</span>
                        <foreach name="val['mission']" item="v">
                            <tr>
                                <td class="first">
                                    任务
                                </td>
                                <td class="circle-warp text-center">
								<span class="circle-sm center-block">
									{++$j}
								</span>
                                </td>
                                <td>
                                    {$v.name} ( {$v.time}h )
                                    <p class="help-block small">
                                        <if condition="!empty($v['info'])">
                                            描述:{$v['info']}
                                        </if>
                                    </p>
                                </td>
                                <td></td>
                            </tr>
                        </foreach>
                    </foreach>
                </table>
            </div>
        </div>
        <else/>
        <h1 class="text-center">该计划未公开</h1>
        <div>
            您可以尝试：
            <a class="btn btn-success" href="{:U(GROUP_NAME.'/Message/send',array('uid'=>$data['uid']))}" target="_blank">
                <span class="glyphicon glyphicon-envelope"></span>
                私信TA索取
            </a>
            <a class="btn btn-info" href="{:U(GROUP_NAME.'/Plan/comment',array('pid'=>$data['id']))}" target="_blank">
                <span class="glyphicon glyphicon-flag"></span>
                评论区留言
            </a>
        </div>
    </if>
</block>